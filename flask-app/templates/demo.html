<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo Interactiva - Laboratorio de Monitoreo</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header>
        <h1>Demo Interactiva del Laboratorio</h1>
        <p>Pruebas en vivo y evidencia del sistema de monitoreo</p>
    </header>

    <nav>
        <a href="/">Inicio</a>
        <a href="/demo">Demo</a>
        <a href="/classic-monitor">Monitor Cl谩sico</a>
        <a href="http://localhost:16686" target="_blank">Jaeger UI</a>
    </nav>

    <main>
        <section id="syslog">
            <h2>Syslog Centralizado</h2>
            <p>Cliente1 env铆a logs v铆a UDP 514 al monitor. Los logs se almacenan en /var/log/cliente1.log.</p>

            <h3>Comandos para Prueba</h3>
            <div class="commands">
                <p><strong>Enviar log desde cliente1:</strong></p>
                <code>docker exec -it cliente1 bash</code>
                <button onclick='copyToClipboard("docker exec -it cliente1 bash")'>Copiar</button>
                <br>
                <br>
                <code>logger "Mensaje de prueba desde Cliente1"</code>
                <button onclick='copyToClipboard("logger \"Mensaje de prueba desde Cliente1\"")'>Copiar</button>
            </div>
            <div class="commands">
                <p><strong>Ver logs en monitor:</strong></p>
                <code>docker exec -it monitor bash</code>
                <button onclick='copyToClipboard("docker exec -it monitor bash")'>Copiar</button>
                <br>
                <br>
                <code>cat /var/log/cliente1.log</code>
                <button onclick='copyToClipboard("cat /var/log/cliente1.log")'>Copiar</button>
            </div>

            <h3>Evidencia</h3>
            <p>Capturas de pantalla de los comandos ejecutados y logs recibidos.</p>
            <img src="{{ url_for('static', filename='images/syslog-evidence.png') }}" alt="Evidencia Syslog" style="max-width:100%; height:auto;">
        </section>

        <section id="snmp">
            <h2>Monitoreo con SNMP</h2>
            <p>
                El contenedor <strong>monitor</strong> act煤a como SNMP Manager y consulta m茅tricas del contenedor
                <strong>cliente1</strong>, que funciona como SNMP Agent, utilizando SNMPv2c con la comunidad
                <em>public</em>.
            </p>

            <h3>Comandos para Prueba</h3>

            <div class="commands">
                <p><strong>Verificar agente SNMP activo en cliente1:</strong></p>
                <p class="description">
                    Confirma que el servicio snmpd se encuentra escuchando en el puerto UDP 161.
                </p>
                <code>docker exec -it cliente1 bash</code>
                <button onclick='copyToClipboard("docker exec -it cliente1 bash")'>Copiar</button>
                <br><br>
                <code>ss -lnup | grep 161</code>
                <button onclick='copyToClipboard("ss -lnup | grep 161")'>Copiar</button>
            </div>

            <div class="commands">
                <p><strong>Consultar nombre del sistema (sysName):</strong></p>
                <p class="description">
                    Identifica el hostname del dispositivo monitoreado. Es 煤til para verificar identidad y alcance del agente.
                </p>
                <code>docker exec -it monitor bash</code>
                <button onclick='copyToClipboard("docker exec -it monitor bash")'>Copiar</button>
                <br><br>
                <code>snmpget -v2c -c public cliente1 1.3.6.1.2.1.1.5.0</code>
                <button onclick='copyToClipboard("snmpget -v2c -c public cliente1 1.3.6.1.2.1.1.5.0")'>Copiar</button>
            </div>

            <div class="commands">
                <p><strong>Consultar tiempo de actividad del sistema (sysUpTime):</strong></p>
                <p class="description">
                    Muestra el tiempo desde que el sistema fue iniciado. Es una m茅trica b谩sica de disponibilidad
                    y detecci贸n de reinicios.
                </p>
                <code>snmpget -v2c -c public cliente1 1.3.6.1.2.1.1.3.0</code>
                <button onclick='copyToClipboard("snmpget -v2c -c public cliente1 1.3.6.1.2.1.1.3.0")'>Copiar</button>
            </div>

            <div class="commands">
                <p><strong>Consultar descripci贸n del sistema (sysDescr):</strong></p>
                <p class="description">
                    Devuelve informaci贸n general sobre el sistema operativo y la plataforma donde corre el agente SNMP.
                </p>
                <code>snmpget -v2c -c public cliente1 1.3.6.1.2.1.1.1.0</code>
                <button onclick='copyToClipboard("snmpget -v2c -c public cliente1 1.3.6.1.2.1.1.1.0")'>Copiar</button>
            </div>

            <div class="commands">
                <p><strong>Listar interfaces de red (ifDescr):</strong></p>
                <p class="description">
                    Permite visualizar las interfaces de red disponibles en el sistema. Es un ejemplo t铆pico
                    de monitoreo de infraestructura mediante SNMP.
                </p>
                <code>snmpwalk -v2c -c public cliente1 1.3.6.1.2.1.2.2.1.2</code>
                <button onclick='copyToClipboard("snmpwalk -v2c -c public cliente1 1.3.6.1.2.1.2.2.1.2")'>Copiar</button>
            </div>

            <div class="commands">
                <p><strong>Resoluci贸n de OIDs mediante MIB (snmptranslate):</strong></p>
                <p class="description">
                    Traduce un identificador simb贸lico definido en la MIB a su correspondiente OID num茅rico.
                    Esto demuestra que el monitor cuenta con las MIBs correctamente instaladas.
                </p>
                <code>snmptranslate -IR sysName.0</code>
                <button onclick='copyToClipboard("snmptranslate -IR sysName.0")'>Copiar</button>
            </div>

            <div class="commands">
                <p><strong>Consulta SNMP utilizando nombre simb贸lico (MIB):</strong></p>
                <p class="description">
                    Realiza una consulta SNMP usando el nombre definido en la MIB, en lugar del OID num茅rico.
                    El resultado es equivalente, pero m谩s legible para el administrador.
                </p>
                <code>snmpget -v2c -c public cliente1 sysName.0</code>
                <button onclick='copyToClipboard("snmpget -v2c -c public cliente1 sysName.0")'>Copiar</button>
            </div>

            <div class="commands">
                <p><strong>Recorrido de informaci贸n del sistema (system group - MIB-II):</strong></p>
                <p class="description">
                    Muestra todas las variables del grupo system, que incluyen nombre, descripci贸n,
                    contacto, ubicaci贸n y tiempo de actividad del sistema.
                </p>
                <code>snmpwalk -v2c -c public cliente1 system</code>
                <button onclick='copyToClipboard("snmpwalk -v2c -c public cliente1 system")'>Copiar</button>
            </div>

            <h3>Evidencia</h3>
            <p>
                Capturas de las consultas SNMP realizadas desde el monitor y las respuestas obtenidas
                (hostname, uptime, descripci贸n del sistema e interfaces de red).
            </p>
            <img src="{{ url_for('static', filename='images/snmp-evidence.png') }}"
                alt="Evidencia SNMP"
                style="max-width:100%; height:auto;">
            <img src="{{ url_for('static', filename='images/snmp-evidence2.png') }}"
                alt="Evidencia SNMP 2"
                style="max-width:100%; height:auto;">
        </section>

        <section id="flask-observabilidad">
            <h2>Flask y Observabilidad</h2>
            <p>Microservicio instrumentado con OpenTelemetry. Cada request genera trazas en Jaeger.</p>

            <h3>Pruebas Interactivas</h3>
            <div class="test-buttons">
                <button onclick="testEndpoint('/ping')">Probar /ping</button>
                <button onclick="testEndpoint('/compute')">Probar /compute</button>
            </div>
            <div id="response"></div>

            <h3>Visualizar Trazas</h3>
            <p>Despu茅s de probar los endpoints, ve a <a href="http://localhost:16686" target="_blank">Jaeger UI</a> y selecciona el servicio "flask-app" para ver las trazas generadas.</p>
        </section>
    </main>

    <footer>
        <p>Demo - Laboratorio de Monitoreo</p>
    </footer>

    <!-- Bot贸n de scroll to top -->
    <button id="scrollToTopBtn" class="scroll-to-top" title="Volver arriba">
        
    </button>

    <script>
        // Scroll to top functionality
        const scrollToTopBtn = document.getElementById('scrollToTopBtn');

        // Mostrar/ocultar bot贸n basado en scroll
        window.addEventListener('scroll', function() {
            if (window.pageYOffset > 300) {
                scrollToTopBtn.classList.add('show');
            } else {
                scrollToTopBtn.classList.remove('show');
            }
        });

        // Scroll suave hacia arriba al hacer click
        scrollToTopBtn.addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
    </script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>